# GET /matchmaking/users

> Сергин Сергей tg:@etteryad

### Входные параметры

Пример:

```
/matchmaking/match?test_name=test_0&epoch=00000000-0000-0000-0000-000000000000
```

- `test_name` - имя теста, их можно найти в папке `/tests`.
- `epoch` - uuid эпохи в тестирующей системе. Между эпохами может проходить любое время, от нескольких секунд, до
  нескольких часов.
  - первый запрос в рамках каждого теста на `/matchmaking/match` должен быть с `epoch=00000000-0000-0000-0000-000000000000`
  - при запросе с `epoch=00000000-0000-0000-0000-000000000000` сервер возвращает Cookie сессии, ей необходимо пользоваться для доступа к запросу `/matchmaking/match`. [Ссылка на requests сессии в Python](https://requests.readthedocs.io/en/latest/user/advanced/)
  - Срок Cookie сессии истекает через 10 минут после её создания, это симуляция временного ограничения в тестах. Вы можете изменить время истечения в файле `/matchmaking/users/routers.go`

### Ответ

Пример:

```json
[
  {
    "user_id": "4877bf28-68a8-4f6c-84a8-707223e9237b",
    "mmr": 2000,
    "roles": ["top", "mid", "bot", "sup", "jungle"],
    "waitingTime": 12
  },
  ...
]
```

- `user_id` - uuid пользователя
- `mmr` - рейтинг пользователя
- `roles` - отранжированный по приоритету список позиций
- `waitingTime` - время ожидания в очереди, в секундах

Вам в ответ может придти любое количество пользователей, но не более 10^5

# POST /matchmaking/match

### Входные параметры

Пример:

```/matchmaking/match?test_name=test_0&epoch=00000000-0000-0000-0000-000000000000```

```json
[
  {
    "match_id": "00000000-0000-0000-0000-000000000000",
    "teams": [
      {
        "side": "red",
        "users": [
          {
            "id": "00000000-0000-0000-0000-000000000000",
            "role": "mid"
          },
          ...
        ]
      },
      {
        "side": "blue",
        "users": [
          {
            "id": "00000000-0000-0000-0000-000000000000",
            "role": "top"
          },
          ...
        ]
      }
    ]
  },
  ...
]
```
- `match_id` - uuid матча
- `teams` - составы команд
  - `side` - сторона команды `(red/blue)`
  - `users` - список игроков команды
    - `id` - uuid пользователя
    - `role` - позиция игрока, которую он занимает в матче

Требует Cookie сессии, получаемый при первом запрое users выше.

### Ответ

```json
{
  "new_epoch": "00000000-0000-0000-0000-000000000000",
  "is_last_epoch": false
}
```
- `new_epoch` - uuid следующей эпохи
- `is_last_epoch` - флаг, который показывает, последняя ли это эпоха

# POST /matchmaking/result

### Входные параметры

Пример:

```/matchmaking/match```

### Ответ

```json
{
    "finished": true,
    "score": 449,
    "session_id": "761393ff-a114-477f-aa5b-dfd3231a32e5",
    "started_at": "2024-07-27T19:09:22.23712+09:00",
    "test_name": "test_2",
    "time_elapsed": "4m20.188225s"
}
```

Требует Cookie сессии, получаемый при первом запрое users выше.
